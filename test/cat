#! /usr/bin/env perl

use strict;
use warnings;

use Test::Simple tests => 30;

my @shortflags = ('b', 'E', 'n', 's', 'T');
my @longflags = ('number-nonblank', 'show-ends', 'number', 'squeeze-blank', 'show-tabs');
my $testfile = "test/cat.txt";

# One short flag
foreach my $flag (@shortflags) {
  ok(`cat -$flag $testfile $testfile $testfile` eq 
     `bin/cat -$flag $testfile $testfile $testfile`)
     or die "Failed with -$flag\n";
}

# One long flag
foreach my $flag (@longflags) {
  ok(`cat --$flag $testfile $testfile $testfile` eq 
     `bin/cat --$flag $testfile $testfile $testfile`)
     or die "Failed with --$flag\n";
}

# Combo of 2 short flags
foreach my $flag (@shortflags) {
  foreach my $flag2 (@shortflags) {
    if ($flag ne $flag2) {
      ok(`cat -$flag$flag2 $testfile $testfile $testfile` eq 
         `bin/cat -$flag$flag2 $testfile $testfile $testfile`)
         or die "Failed with -$flag$flag2\n";
    }
  }
}
